<div class="container">
  <div class="recipe-detail">
    <div class="recipe-detail-header">
      <h2><%= @recipe.title %></h2>
      <p class="recipe-detail-author">ÊäïÁ®øËÄÖ: <%= @recipe.user.nickname %></p>
    </div>
    
    <div class="recipe-detail-image">
      <% if @recipe.image.attached? %>
        <%= image_tag @recipe.image, alt: @recipe.title %>
      <% else %>
        <%= image_tag "https://via.placeholder.com/400x300/87CEEB/FFFFFF?text=#{@recipe.title}", alt: @recipe.title %>
      <% end %>
    </div>
    
    <div class="recipe-detail-content">
      <p class="recipe-detail-description"><%= @recipe.description %></p>
      
      <div class="recipe-detail-stats">
        <span class="likes">‚ù§Ô∏è <%= @recipe.likes.count %></span>
        <span class="comments">üí¨ <%= @recipe.comments.count %></span>
      </div>
      
      <div class="recipe-detail-actions">
        <% if user_signed_in? %>
          <% if @recipe.liked_by?(current_user) %>
            <%= link_to "„ÅÑ„ÅÑ„Å≠Ê∏à„Åø", recipe_like_path(@recipe, @recipe.likes.find_by(user: current_user)), method: :delete, class: "btn btn-primary" %>
          <% else %>
            <%= link_to "„ÅÑ„ÅÑ„Å≠", recipe_likes_path(@recipe), method: :post, class: "btn btn-primary" %>
          <% end %>
        <% end %>
        <%= link_to "„Ç≥„É°„É≥„Éà", "#comments", class: "btn btn-secondary" %>
        
        <% if user_signed_in? && @recipe.user == current_user %>
          <%= link_to "ÂâäÈô§", recipe_path(@recipe),
            data: { turbo_method: :delete, confirm: "Êú¨ÂΩì„Å´ÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü" },
            class: "btn btn-danger" %>

        <% end %>
      </div>
      
      <!-- „Ç≥„É°„É≥„Éà„Çª„ÇØ„Ç∑„Éß„É≥ -->
      <div id="comments" class="comments-section">
        <h3>„Ç≥„É°„É≥„Éà</h3>
        <% @recipe.comments.each do |comment| %>
          <div class="comment">
            <p class="comment-author"><%= comment.user.nickname %></p>
            <p class="comment-content"><%= comment.content %></p>
            <p class="comment-date"><%= comment.created_at.strftime("%YÂπ¥%mÊúà%dÊó• %H:%M") %></p>
          </div>
        <% end %>
        
        <% if user_signed_in? %>
          <div class="comment-form">
            <%= form_with model: [@recipe, @comment], local: true do |form| %>
              <div class="form-group">
                <%= form.text_area :content, placeholder: "„Ç≥„É°„É≥„Éà„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ", rows: 3, required: true %>
              </div>
              <%= form.submit "„Ç≥„É°„É≥„ÉàÊäïÁ®ø", class: "btn btn-primary" %>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
