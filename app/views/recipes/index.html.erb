<div class="container">
  <!-- ウェルカムメッセージ -->
  <section class="welcome-section">
    <h2>子供が喜ぶ美味しいレシピを共有しよう！</h2>
    <p>偏食の子供も思わず食べたくなる、みんなのアイデアレシピをチェック</p>
    
    <!-- 検索フォーム -->
    <div class="search-form">
      <%= form_with url: recipes_path, method: :get, local: true, class: "search-form-container" do |form| %>
        <div class="search-input-group">
          <%= form.text_field :search, placeholder: "レシピを検索（例：ハンバーグ、にんじん、野菜）", 
                              value: params[:search], class: "search-input" %>
          <%= form.submit "🔍 検索", class: "btn btn-primary search-btn" %>
        </div>
      <% end %>
    </div>
    
    <% if user_signed_in? %>
      <div class="welcome-actions">
        <%= link_to "新しいレシピを投稿", new_recipe_path, class: "btn btn-primary btn-large" %>
      </div>
    <% end %>
  </section>

  <!-- レシピ一覧 -->
  <section class="recipes-section">
    <% if params[:search].present? %>
      <div class="search-results-header">
        <h3>「<%= params[:search] %>」の検索結果</h3>
        <p class="search-results-count"><%= @recipes.count %>件のレシピが見つかりました</p>
        <%= link_to "すべてのレシピを表示", recipes_path, class: "btn btn-outline search-clear-btn" %>
      </div>
    <% else %>
      <h3>みんなのレシピ</h3>
    <% end %>
    <% if @recipes.any? %>
      <div class="recipes-grid">
        <% @recipes.each do |recipe| %>
        <div class="recipe-card">
          <div class="recipe-image">
            <% if recipe.image.attached? %>
              <%=  image_tag recipe.image.variant(resize: '250x150'), class: 'racipe-image' %>
            <% else %>
              <%= image_tag "https://via.placeholder.com/300x200/87CEEB/FFFFFF?text=#{recipe.title}", alt: recipe.title %>
            <% end %>
          </div>
          <div class="recipe-content">
            <h4><%= recipe.title %></h4>
            <p class="recipe-author">投稿者: <%= recipe.user.nickname %></p>
            <p class="recipe-description"><%= truncate(recipe.description, length: 100) %></p>
            <div class="recipe-stats">
              <span class="likes">❤️ <%= recipe.likes.count %></span>
              <span class="comments">💬 <%= recipe.comments.count %></span>
              
            </div>
            <%= link_to "詳細を見る", recipe_path(recipe), class: "btn btn-secondary" %>
          </div>
        </div>
      <% end %>
      </div>
    <% else %>
      <div class="empty-state">
        <% if params[:search].present? %>
          <p>「<%= params[:search] %>」に関するレシピが見つかりませんでした。</p>
          <p>別のキーワードで検索してみてください。</p>
          <%= link_to "すべてのレシピを表示", recipes_path, class: "btn btn-primary" %>
        <% else %>
          <p>まだレシピが投稿されていません。</p>
          <% if user_signed_in? %>
            <%= link_to "最初のレシピを投稿", new_recipe_path, class: "btn btn-primary" %>
          <% end %>
        <% end %>
      </div>
    <% end %>
  </section>
</div>